<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
<head>
    <title>Spring Security Example</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Jua&family=Nanum+Gothic+Coding:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'text': '#10181e',
                        'background': '#ffffff',
                        'shade': '#D9D9D9',
                        'primary': '#18517b',
                        'secondary': '#aad1ee',
                        'tertiary': '#226faa',
                        'accent': '#4e4ea2',
                    },
                    fontFamily: {
                        'sans': ['Open Sans', 'sans-serif'],
                        'inter': ['Inter', 'sans-serif'],
                        'jua': ['Jua', 'sans-serif'],
                        'nanum': ['Nanum Gothic Coding', 'sans-serif'],
                    },
                    fontSize: {
                        'base': '16px',
                        'lg': '25.8px',
                        'xl': '41.8px',
                        '2xl': '67.8px',
                    },
                }
            }
        }
    </script>
    <style>
        @tailwind base;
        @tailwind components;
        @tailwind utilities;

        :root {
            font-family: 'nanum', sans-serif;
            font-size: 16px;
            font-weight: 400;
            line-height: 1.5;
            color: #10181e;
            background-color: #ffffff;
        }

        @layer base {

            h1 {
                @apply text-2xl;
            }
            h2 {
                @apply text-xl;
            }
            h3 {
                @apply text-lg;
            }
        }

        nav .title {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-weight: bold;
            font-family: 'Inter', sans-serif;
        }

        #tooltip::before {
            content: '';
            position: absolute;
            left: -15px; /* Adjust based on the size of the triangle */
            top: 25%; /* Adjust if necessary to align with the input field */
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 15px solid white; /* Color of the triangle should match the tooltip background */
            transform: translateY(-50%);
        }

    </style>
</head>
<body>
<nav class="bg-primary h-[10vh]">
    <div class="w-[434px] mx-auto text-2xl title">
        <h1>NoFreeRider</h1>
    </div>
    <div class="w-full h-full flex flex-row justify-end items-center px-[51px]">
        <button class="button text-lg bg-shade text-center w-[170px] h-[60px]">Sign Out</button>
    </div>
</nav>

<!--main-->
<div class="flex h-[90vh]">
    <!-- Sidebar with user overview and project list -->
    <aside class="w-1/4 h-full bg-secondary p-8 space-y-4">
        <div class="bg-primary text-white p-4 rounded-2xl">
            <h2 class="text-xl font-bold">Overview</h2>
            <!-- Form fields or user info here -->
            <div class="mt-4 space-y-2">
                <!-- Placeholder for form fields -->
                <div class="bg-white p-2 rounded">
                    <span class="text-md text-black">수업이름</span>
                    <br>
                    <span class="text-lg text-black" th:text="${project.className()}">YC Tech</span>
                </div>
                <div class="bg-white p-2 rounded">
                    <span class="text-md text-black">프로젝트 일자</span>
                    <br>
                    <span class="text-lg text-black" th:text="${#dates.format(project.startDate(), 'yyyy.MM.dd')} + ' ~ ' + ${#dates.format(project.endDate(), 'yyyy.MM.dd')}"></span>
                </div>
                <!-- ... -->
            </div>
            <button class="mt-4 bg-accent text-white p-2 rounded w-full">작업 중</button>
        </div>
        <!-- List of projects or classes -->
        <div class="bg-primary text-white p-4 rounded-2xl">
            <h2 class="text-xl font-bold">참여 인원</h2>
            <!-- Form fields or user info here -->
            <div class="mt-4 space-y-2">
                <!-- Placeholder for form fields -->
                <div class="bg-white p-2 rounded" th:each="member: ${memberList}">
                    <span class="text-md text-black" th:text="${member.name()} + '님 ' + ${member.studentId()}"></span>
                </div>
                <!-- Add Member Button -->
                <div class="relative w-full">
                    <button id="addMemberButton" onclick="toggleTooltip()" class="w-full bg-white p-2 rounded flex items-center justify-center hover:bg-gray-100 transition duration-300 ease-in-out">
                        <span class="text-md text-black font-semibold flex items-center">
                            <i class="fas fa-plus mr-2"></i> Add Member
                        </span>
                    </button>
                    <!-- Tooltip -->
                    <div id="tooltip" class="absolute left-full top-[-50%] mt-2 w-64 bg-white rounded-md shadow-xl z-20 p-4 ml-4 hidden">
                        <input id="newMemberEmail" type="email" class="border border-gray-300 p-2 rounded w-full mb-2 text-black" placeholder="Member Email">
                        <button id="addMemberADD" class="bg-primary text-white p-2 rounded w-full">ADD</button>
                    </div>
                </div>
                <!-- ... -->
            </div>
        </div>
    </aside>

    <!-- Main content with task list -->
    <main class="flex-1 bg-white p-8">
        <!-- header -->
        <div class="flex items-center text-xl text-primary font-bold">
            <!-- Icon Button -->
            <a href="/main" class="ml-2 text-primary hover:text-primary-dark">
                <i class="fa fa-home" aria-hidden="true"></i>
            </a>
            <span class="mx-4">></span>
            <span th:text="${project.name()}"></span>
        </div>
        <div class="space-y-6">
            <!-- Task item -->
            <div class="shadow-lg p-4 rounded-lg">
                <h3 class="text-primary text-lg mb-2">Task 이름</h3>
                <p class="text-tertiary mb-4">
                    Task 내용
                </p>
                <!-- Task checklist -->
                <ul class="list-none space-y-2">
                    <li class="flex items-center">
                        <input id="checkbox1" type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded" checked>
                        <label for="checkbox1" class="ml-2 text-text">Checklist item 1</label>
                    </li>
                    <li class="flex items-center">
                        <input id="checkbox2" type="checkbox" class="form-checkbox h-5 w-5 text-primary rounded">
                        <label for="checkbox2" class="ml-2 text-text">Checklist item 2</label>
                    </li>
                    <!-- Repeat for other checklist items -->
                </ul>
                <div class="flex justify-end items-center mt-4">
                    <span class="text-text">2023.11.04까지</span>
                    <span class="text-primary ml-4">진행도 66%</span>
                </div>
            </div>
            <!-- More tasks here -->
        </div>
        <!-- Button to add a new task -->
        <button class="fixed bottom-8 right-8 bg-primary text-white p-4 rounded-full shadow-lg"
                onclick="document.getElementById('task-modal').style.display='block'">
            +
        </button>

        <!-- modal -->
        <!-- Task Modal Background -->
        <div class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full" id="task-modal" style="display: none;">
            <!-- Task Modal -->
            <div class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-md shadow-lg w-1/3">
                <!-- Modal Header -->
                <div class="bg-primary text-white text-xl font-bold py-4 px-6 rounded-t-md">
                    Add New Task
                </div>

                <!-- Modal Body -->
                <div class="p-6">
                    <form id="newTaskForm">
                        <!-- Task Name -->
                        <div class="mb-4">
                            <label for="taskName" class="block text-gray-700 text-sm font-bold mb-2">Task Name:</label>
                            <input type="text" id="taskName" name="taskName" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>

                        <!-- Task Description -->
                        <div class="mb-4">
                            <label for="taskDescription" class="block text-gray-700 text-sm font-bold mb-2">Task Description:</label>
                            <textarea id="taskDescription" name="taskDescription" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required></textarea>
                        </div>

                        <!-- Task Due Date -->
                        <div class="mb-4">
                            <label for="dueDate" class="block text-gray-700 text-sm font-bold mb-2">Due Date:</label>
                            <input type="date" id="dueDate" name="dueDate" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>

                        <!-- Modal Footer -->
                        <div class="flex justify-end pt-2">
                            <button type="submit" class="px-4 bg-primary text-white p-3 rounded-lg hover:bg-primary-dark focus:outline-none focus:shadow-outline">Save</button>
                            <button type="button" class="ml-2 px-4 bg-gray-500 text-white p-3 rounded-lg hover:bg-gray-600 focus:outline-none focus:shadow-outline" onclick="document.getElementById('task-modal').style.display='none'">Cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>
</div>



<script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script>
    function toggleTooltip() {
        var tooltip = document.getElementById('tooltip');
        tooltip.classList.remove('hidden');
    }

    // Hide tooltip when clicking outside
    document.addEventListener('click', function(event) {
        var tooltip = document.getElementById('tooltip');
        var button = document.querySelector('#addMemberButton'); // Replace with a more specific selector if needed

        // Check if the clicked area is outside the tooltip and button
        if (!tooltip.contains(event.target) && !button.contains(event.target)) {
            tooltip.classList.add('hidden');
        }
    });

    // Prevent event from closing tooltip when clicking inside
    document.getElementById('tooltip').addEventListener('click', function(event) {
        event.stopPropagation();
    });

    // Add member button
    document.getElementById('addMemberADD').addEventListener('click', function(event) {
        event.preventDefault();
        var tooltip = document.getElementById('tooltip');
        tooltip.classList.add('hidden');
        var newMemberEmail = document.getElementById('newMemberEmail').value;
        const projectId = location.pathname.split('/')[2];
        const data = {
            memberEmail: newMemberEmail
        };
        console.log(data)
        // curl api
        // generate invite link
        $.ajax({
            url: 'http://localhost:8080/projects/' + projectId + '/invite',
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            data: JSON.stringify(data),
            success: function(data) {
                console.log(data);
                alert('초대 링크가 전송되었습니다.');
            },
            error: function(request, status, error) {
                console.log(error);
                alert('초대 링크 전송에 실패했습니다.')
            }
        });
    });




</script>
</body>
</html>